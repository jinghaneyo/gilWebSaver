================================================================================
                            gilWebSaver
================================================================================

프로젝트 개요
--------------------------------------------------------------------------------
gilWebSaver는 Chrome 확장 프로그램으로, 웹 페이지를 HTML 형식으로
로컬에 저장할 수 있는 도구입니다. URL은 사라질 수 있으므로 실제 웹 페이지
내용을 보존하는 것이 목적입니다.

버전: 1.0
Manifest 버전: 3


주요 기능
--------------------------------------------------------------------------------

1. 전체 페이지 저장
   - 현재 웹 페이지 전체를 HTML 파일로 저장
   - CSS, 이미지, 스타일 등을 포함하여 완전한 웹 페이지 보존
   - 비동기 저장 기능으로 안정적인 다운로드

2. 영역 선택 저장
   - 웹 페이지의 특정 영역만 선택하여 저장
   - 마우스 hover로 요소 미리보기 (파란색 점선 테두리)
   - 클릭으로 여러 영역 선택 가능 (녹색 실선 테두리 + 체크 배지)
   - 선택한 영역만 HTML로 추출하여 저장

3. 이미지 처리 강화
   - Base64로 인코딩된 이미지 처리
   - 외부 이미지 URL 처리 및 다운로드

4. 오류 처리
   - 타사 스크립트 오류 무시 (Drift, Intercom, Google Analytics 등)
   - 프레임워크 오류 무시 (React, Vue, Next.js 등)
   - WebSocket 관련 오류 차단


프로젝트 구조
--------------------------------------------------------------------------------

gilWebSaver/
│
├── manifest.json           # Chrome 확장 프로그램 설정 파일
│                          # - 권한, 메타데이터, 진입점 정의
│
├── popup.html             # 확장 프로그램 팝업 UI
├── popup.js               # 팝업 로직 및 사용자 인터랙션 처리
│                          # - 전체 페이지 저장 버튼
│                          # - 영역 선택 모드 토글
│                          # - 선택 영역 저장 버튼
│                          # - 선택 초기화 버튼
│
├── background.js          # 백그라운드 서비스 워커
│                          # - 파일 다운로드 처리
│                          # - 사이드 패널 설정
│
├── content.js             # 웹 페이지에 주입되는 스크립트
│                          # - 페이지 컨텐츠 추출 및 저장
│                          # - 영역 선택 UI 및 인터랙션
│                          # - 이미지 처리 및 Base64 변환
│                          # - 타사 스크립트 오류 차단
│
├── sidepanel.html         # 사이드 패널 UI
├── sidepanel.js           # 사이드 패널 로직
│                          # - popup.js와 유사한 기능
│
├── panel.html             # 추가 패널 UI
└── panel.js               # 추가 패널 로직


권한 (Permissions)
--------------------------------------------------------------------------------
- activeTab       : 현재 활성 탭에 접근
- storage         : 로컬 스토리지 사용
- downloads       : 파일 다운로드
- tabs            : 탭 정보 접근
- scripting       : 스크립트 주입
- windows         : 윈도우 관리
- sidePanel       : 사이드 패널 표시
- <all_urls>      : 모든 웹 사이트 접근


사용 방법
--------------------------------------------------------------------------------

1. 확장 프로그램 설치
   - Chrome 브라우저에서 chrome://extensions/ 접속
   - "개발자 모드" 활성화
   - "압축해제된 확장 프로그램 로드" 클릭
   - 이 프로젝트 폴더 선택

2. 전체 페이지 저장
   - 저장하고 싶은 웹 페이지에서 확장 프로그램 아이콘 클릭
   - "전체 페이지 저장" 버튼 클릭
   - 다운로드 폴더에 HTML 파일 저장됨

3. 영역 선택 저장
   - "영역 선택 모드" 버튼 클릭 (버튼이 주황색으로 변경됨)
   - 웹 페이지에서 원하는 영역 위로 마우스 이동 (파란색 테두리 표시)
   - 클릭하여 영역 선택 (녹색 테두리 + 체크 배지 표시)
   - 여러 영역 선택 가능
   - "선택 영역 저장" 버튼 클릭
   - 선택한 영역만 HTML로 저장됨

4. 선택 초기화
   - "선택 초기화" 버튼으로 선택한 영역 모두 해제


주요 컴포넌트 설명
--------------------------------------------------------------------------------

1. background.js
   - downloadFile(): 파일 다운로드 처리 및 완료 대기
   - waitForDownloadComplete(): 다운로드 상태 모니터링

2. popup.js / sidepanel.js
   - ensureContentScriptLoaded(): content.js 주입 확인 및 로드
   - 각 버튼 이벤트 핸들러
   - 상태 메시지 표시 (성공/실패)

3. content.js (주요 기능)
   - 선택 모드 관리 (enableSelectMode / disableSelectMode)
   - 요소 선택 UI (hover, click 핸들러)
   - HTML 컨텐츠 추출 (전체/선택)
   - 이미지 처리 및 Base64 변환
   - 타사 스크립트 오류 차단


기술 스택
--------------------------------------------------------------------------------
- Chrome Extension Manifest V3
- JavaScript (Vanilla)
- HTML5
- Chrome Extensions API
  - chrome.downloads
  - chrome.tabs
  - chrome.scripting
  - chrome.sidePanel
  - chrome.storage


최근 업데이트 (Git Log 기준)
--------------------------------------------------------------------------------
1. PDF 변환 기능 제거 (실패한 기능)

2. 크롬 플러그인 - 비동기 저장 기능 개선 및 이미지 처리 강화,
   사이드 패널 고정 버튼 제거

3. 크롬 플러그인 - 다운로드 처리 및 사이드 패널 설정, UI 개선

4. 크롬 플러그인 - 웹페이지를 html로 로컬에 저장.
   url은 사라질수도 있으니 실제 내용을 저장


참고 사항
--------------------------------------------------------------------------------
- 일부 웹사이트는 보안 정책(CSP)으로 인해 완벽하게 저장되지 않을 수 있음
- 다운로드된 파일은 기본 다운로드 폴더에 저장됨
- 같은 이름의 파일이 있으면 자동으로 번호가 추가됨 (uniquify)


문제 해결
--------------------------------------------------------------------------------
- "스크립트 로드 실패" 에러: 페이지를 새로고침하고 다시 시도
- 선택 모드가 작동하지 않음: content.js가 제대로 주입되었는지 확인
- 다운로드 실패: Chrome의 다운로드 권한 확인


라이선스
--------------------------------------------------------------------------------
이 프로젝트는 개인 프로젝트입니다.

